version: "3.9"

services:
  cowrie:
    image: cowrie/cowrie:latest
    container_name: cowrie
    restart: unless-stopped
    network_mode: host
    volumes:
      - cowrie_logs:/cowrie/cowrie-git/var/log/cowrie
      - ./cowrie.cfg:/cowrie/etc/cowrie.cfg:ro
    environment:
      - COWRIE_HOSTNAME=srv01
  cowrie-api:
    image: ghcr.io/sirgeon/cowrie-api:latest
    container_name: cowrie-api
    restart: unless-stopped
    ports:
      - "3000:3000" # Expose API to host (bind to 127.0.0.1 in prod!)
    volumes:
      - cowrie_logs:/cowrie/var/log/cowrie:ro
    environment:
      - COWRIE_LOG_PATH=/cowrie/var/log/cowrie/cowrie.json
      - RUST_LOG=info
    depends_on:
      - cowrie
    networks:
      - honeypot

volumes:
  cowrie_logs:

networks:
  honeypot:
    driver: bridge
